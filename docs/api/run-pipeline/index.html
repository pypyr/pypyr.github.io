<!doctype html><html lang=en dir=ltr prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>run pipeline api | pypyr</title><meta name=description content="Use the Python API to run task-runner pipeline workflows from your own code in a few simple lines."><link rel=stylesheet href=https://pypyr.io/css/styles.min.5173637d874e012d84bb859e8f72791eb48cf798feeff3480b1db6bfa97be924.css integrity="sha256-UXNjfYdOAS2Eu4Wej3J5HrSM95j+7/NICx22v6l76SQ="><link rel=stylesheet href=https://pypyr.io/css/code-highlight.min.78f63f1d4f45beaf423efd3dc8e6914c2abdca1b5391cd91368a32efecd9d7e3.css integrity="sha256-ePY/HU9Fvq9CPv09yOaRTCq9yhtTkc2RNooy7+zZ1+M="><script defer src=https://pypyr.io/js/script.min.8c51c28efa613c3bc853b2418e260b33482af182f6ca8ebeeb825b5b8e094423.js integrity="sha256-jFHCjvphPDvIU7JBjiYLM0gq8YL2yo6+64JbW44JRCM="></script>
<link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,700%7cRoboto+Mono:400,400i&display=swap" rel=stylesheet><link rel=canonical href=https://pypyr.io/docs/api/run-pipeline/><script async src="https://www.googletagmanager.com/gtag/js?id=UA-147150909-1"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-147150909-1")</script><meta property="og:description" content="Use the Python API to run task-runner pipeline workflows from your own code in a few simple lines."><meta property="og:image" content="https://pypyr.io/images/1.91x1/pypyr-taskrunner-yaml-pipeline-automation-1200x628.5aa6465b3b9d2ca8d0d5a9f794ba7f379c522a8ba503129f2a35d2479ea2452d.png"><meta property="og:image:alt" content="pypyr is an open-source task-runner for automation pipelines defined in simple human-readable yaml."><meta property="og:image:height" content="628"><meta property="og:image:type" content="image/png"><meta property="og:image:width" content="1200"><meta property="og:site_name" content="pypyr technical documentation"><meta property="og:title" content="Run an automation pipeline programmatically in your own code."><meta property="og:type" content="website"><meta property="og:url" content="https://pypyr.io/docs/api/run-pipeline/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@pypyrpipes"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@id":"https://pypyr.io/#organization","@type":"Organization","name":"pypyr","url":"https://pypyr.io/","description":"The pypyr project is a free open-source task-runner cli \u0026 python api for automation pipelines.","logo":{"@type":"ImageObject","url":"https://pypyr.io/images/pypyr-taskrunner-logo-square.63875e43ff40d8ae40e93a6043b4328b962f54f52974aaa27cedec52220de665.svg","height":112,"width":112},"sameAs":["https://github.com/pypyr/","https://twitter.com/pypyrpipes/","https://pypi.org/user/pypyr/","https://hub.docker.com/u/pypyr/","https://en.gravatar.com/pypyr/"]},{"@type":"TechArticle","author":{"@type":"Person","name":"pypyr contributor"},"articleSection":"api","dateModified":"2022-03-09T12:15:05Z","datePublished":"2020-08-13T00:00:00Z","headline":"Run an automation pipeline programmatically in your own code.","image":[{"@type":"ImageObject","url":"https://pypyr.io/images/1x1/pypyr-taskrunner-yaml-pipeline-automation-1200x1200.52764d3c6f40232b3cdc33f5b8fbaeadad56cc310c8dd5588d30828296b5290d.png","height":1200,"width":1200},{"@type":"ImageObject","url":"https://pypyr.io/images/4x3/pypyr-taskrunner-yaml-pipeline-automation-1200x900.e8e70443377aeb11c190835e8d2ed0c844d31a82a0c2e8a744a9999cd03e0de9.png","height":900,"width":1200},{"@type":"ImageObject","url":"https://pypyr.io/images/16x9/pypyr-taskrunner-yaml-pipeline-automation-1920x1080.cc9ae11626c8312e087058adb13bfff702162ce39c355065170c1b87850f3034.png","height":1080,"width":1920}],"inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https://pypyr.io/docs/api/run-pipeline/"},"publisher":{"@id":"https://pypyr.io/#organization"},"url":"https://pypyr.io/docs/api/run-pipeline/","wordCount":2248}]}</script><link rel=apple-touch-icon sizes=180x180 href=/favicons/apple-touch-icon.925deabb48d91a80924b5d04ff56d2b8f42ba1d1e1438cb7d8948cce1138208c.png><link rel=icon type=image/png sizes=32x32 href=/favicons/favicon-32x32.b869433d27c4679a5fbce03a8489268a539cbc781259bff14618ae2f018334e6.png><link rel=icon type=image/png sizes=16x16 href=/favicons/favicon-16x16.8bcd9f870e0a86445e0505ce6e816b76a40b08a06e2dcd1ec1f90c395ecbeaf6.png><link rel=manifest href=/favicons/site.3dad2bd5063ad6bc11f741ea28adf4df8b9370196f6e64af6789cf181cef05c6.webmanifest><link rel="shortcut icon" href=/favicons/favicon.4a2a3dffd965a7c571df0375e35f59307bc72adc08e3ef7021d5d5f02e6ef5a8.ico><meta name=msapplication-TileColor content="#00aba9"><meta name=msapplication-config content="/favicons/browserconfig.bbdaec7f39b7bd1f2d6bc484afdd0c7246e3af9c5b45d91198d8a3b42e024e1f.xml"><meta name=theme-color content="#121212"></head><body class=docs-grid><header class="header elevation-01"><a href=/ class=top-nav-logo aria-label=home><img class=top-nav-logo-img src=https://pypyr.io/images/pypyr-logotype.2c9aa98c472f0ea8d436597c26ef1b0f042624ee19cdf69bcb89ac0025d146c4.svg alt="pypyr logo"></a><nav class=top-nav-links aria-label="top navigation"><ul><li><a href=/docs/ class=top-active>docs</a></li><li><a href=/updates/>updates</a></li><li><a href=/topics/>topics</a></li><li><a href=https://twitter.com/pypyrpipes/><span class=top-nav-links-pre><svg viewBox="0 0 250 203.18"><title>twitter link</title><use xlink:href="https://pypyr.io/images/twitter-logo.4bee83a61c7b1a567b9a00ea1ac9388de3b16ffbffac9e228f998a5411894c59.svg#twitter-logo"/></svg></span></a></li><li><a href=https://github.com/pypyr/pypyr/><span class=top-nav-links-pre><svg viewBox="0 0 477 97.41"><title>github repo</title><use xlink:href="https://pypyr.io/images/github-mark-and-logo.5df312655c6a99a4953b544d02b13a948fa4d66bda21e772206f0ed96663f05b.svg#github-mark-and-logo"/></svg></span></a></li></ul></nav></header><button id=show-leftnav class="neutral-button icon-button primary-button"><svg class="show-leftnav-chevron"><title>open main navigation menu</title><use href="https://pypyr.io/icons/chevron-right.e586e5df0f820697b2ce08d042d0110568a2faeb11c7f0bab5a33df79dd3d6db.svg#chevron-right"/></svg></button><nav id=leftnavmenu class="leftnavmenu elevation-03" aria-label="Primary Navigation"><button id=hide-leftnav class="neutral-button icon-button"><svg class="hide-leftnav-chevron"><title>close navigation menu</title><use href="https://pypyr.io/icons/chevron-right.e586e5df0f820697b2ce08d042d0110568a2faeb11c7f0bab5a33df79dd3d6db.svg#chevron-right"/></svg></button><ul class=leftnavroot><li><button class="nav-section-chevron-title neutral-button">
<span class=nav-section-pointer><svg class="nav-chevron"><title>open or close sub-menu</title><use href="https://pypyr.io/icons/chevron-right.e586e5df0f820697b2ce08d042d0110568a2faeb11c7f0bab5a33df79dd3d6db.svg#chevron-right"/></svg><span>getting started</span></span></button><ul class=nested><li><a href=/docs/getting-started/>overview</a></li><li><a href=/docs/getting-started/installation/>install pypyr</a></li><li><a href=/docs/getting-started/run-your-first-pipeline/>run your first pipeline</a></li><li><a href=/docs/getting-started/basic-concepts/>basic concepts</a></li><li><a href=/docs/getting-started/variables/>variables</a></li><li><a href=/docs/getting-started/conditional-logic/>conditional logic</a></li><li><a href=/docs/getting-started/loops/>loops</a></li><li><a href=/docs/getting-started/error-handling/>error handling</a></li><li><a href=/docs/getting-started/config/>config</a></li></ul></li><li><button class="nav-section-chevron-title neutral-button">
<span class=nav-section-pointer><svg class="nav-chevron"><title>open or close sub-menu</title><use href="https://pypyr.io/icons/chevron-right.e586e5df0f820697b2ce08d042d0110568a2faeb11c7f0bab5a33df79dd3d6db.svg#chevron-right"/></svg><span>cli</span></span></button><ul class=nested><li><a href=/docs/cli/>overview</a></li><li><a href=/docs/cli/run-a-pipeline/>run a pipeline</a></li><li><a href=/docs/cli/custom-args/>custom args</a></li></ul></li><li><button class="nav-section-chevron-title neutral-button">
<span class=nav-section-pointer><svg class="nav-chevron"><title>open or close sub-menu</title><use href="https://pypyr.io/icons/chevron-right.e586e5df0f820697b2ce08d042d0110568a2faeb11c7f0bab5a33df79dd3d6db.svg#chevron-right"/></svg><span>pipelines</span></span></button><ul class=nested><li><a href=/docs/pipelines/>overview</a></li><li><a href=/docs/pipelines/pipeline-structure/>pipeline structure</a></li><li><a href=/docs/pipelines/lookup-order/>lookup order</a></li><li><a href=/docs/pipelines/shortcuts/>shortcuts</a></li><li><a href=/docs/pipelines/builtin-pipelines/>built-in pipelines</a></li></ul></li><li><button class="nav-section-chevron-title neutral-button">
<span class=nav-section-pointer><svg class="nav-chevron"><title>open or close sub-menu</title><use href="https://pypyr.io/icons/chevron-right.e586e5df0f820697b2ce08d042d0110568a2faeb11c7f0bab5a33df79dd3d6db.svg#chevron-right"/></svg><span>context parsers</span></span></button><ul class=nested><li><a href=/docs/context-parsers/>overview</a></li><li><a href=/docs/context-parsers/dict/>dict</a></li><li><a href=/docs/context-parsers/json/>json</a></li><li><a href=/docs/context-parsers/jsonfile/>jsonfile</a></li><li><a href=/docs/context-parsers/keys/>keys</a></li><li><a href=/docs/context-parsers/keyvaluepairs/>keyvaluepairs</a></li><li><a href=/docs/context-parsers/list/>list</a></li><li><a href=/docs/context-parsers/string/>string</a></li><li><a href=/docs/context-parsers/tomlfile/>tomlfile</a></li><li><a href=/docs/context-parsers/yamlfile/>yamlfile</a></li></ul></li><li><button class="nav-section-chevron-title neutral-button">
<span class=nav-section-pointer><svg class="nav-chevron"><title>open or close sub-menu</title><use href="https://pypyr.io/icons/chevron-right.e586e5df0f820697b2ce08d042d0110568a2faeb11c7f0bab5a33df79dd3d6db.svg#chevron-right"/></svg><span>decorators</span></span></button><ul class=nested><li><a href=/docs/decorators/>overview</a></li><li><a href=/docs/decorators/comment/>comment</a></li><li><a href=/docs/decorators/description/>description</a></li><li><a href=/docs/decorators/foreach/>foreach</a></li><li><a href=/docs/decorators/in/>in</a></li><li><a href=/docs/decorators/onerror/>onError</a></li><li><a href=/docs/decorators/retry/>retry</a></li><li><a href=/docs/decorators/run/>run</a></li><li><a href=/docs/decorators/skip/>skip</a></li><li><a href=/docs/decorators/swallow/>swallow</a></li><li><a href=/docs/decorators/while/>while</a></li></ul></li><li><button class="nav-section-chevron-title neutral-button">
<span class=nav-section-pointer><svg class="nav-chevron"><title>open or close sub-menu</title><use href="https://pypyr.io/icons/chevron-right.e586e5df0f820697b2ce08d042d0110568a2faeb11c7f0bab5a33df79dd3d6db.svg#chevron-right"/></svg><span>steps</span></span></button><ul class=nested><li><a href=/docs/steps/>overview</a></li><li><a href=/docs/steps/add/>add</a></li><li><a href=/docs/steps/append/>append</a></li><li><a href=/docs/steps/assert/>assert</a></li><li><a href=/docs/steps/call/>call</a></li><li><a href=/docs/steps/cmd/>cmd</a></li><li><a href=/docs/steps/configvars/>configvars</a></li><li><a href=/docs/steps/contextclear/>contextclear</a></li><li><a href=/docs/steps/contextclearall/>contextclearall</a></li><li><a href=/docs/steps/contextcopy/>contextcopy</a></li><li><a href=/docs/steps/contextmerge/>contextmerge</a></li><li><a href=/docs/steps/contextsetf/>contextsetf</a></li><li><a href=/docs/steps/debug/>debug</a></li><li><a href=/docs/steps/default/>default</a></li><li><a href=/docs/steps/echo/>echo</a></li><li><a href=/docs/steps/env/>env</a></li><li><a href=/docs/steps/envget/>envget</a></li><li><a href=/docs/steps/fetchjson/>fetchjson</a></li><li><a href=/docs/steps/fetchtoml/>fetchtoml</a></li><li><a href=/docs/steps/fetchyaml/>fetchyaml</a></li><li><a href=/docs/steps/fileformat/>fileformat</a></li><li><a href=/docs/steps/fileformatjson/>fileformatjson</a></li><li><a href=/docs/steps/fileformattoml/>fileformattoml</a></li><li><a href=/docs/steps/fileformatyaml/>fileformatyaml</a></li><li><a href=/docs/steps/fileread/>fileread</a></li><li><a href=/docs/steps/filereplace/>filereplace</a></li><li><a href=/docs/steps/filewrite/>filewrite</a></li><li><a href=/docs/steps/filewritejson/>filewritejson</a></li><li><a href=/docs/steps/filewritetoml/>filewritetoml</a></li><li><a href=/docs/steps/filewriteyaml/>filewriteyaml</a></li><li><a href=/docs/steps/glob/>glob</a></li><li><a href=/docs/steps/jsonparse/>jsonparse</a></li><li><a href=/docs/steps/jump/>jump</a></li><li><a href=/docs/steps/now/>now</a></li><li><a href=/docs/steps/nowutc/>nowutc</a></li><li><a href=/docs/steps/pathcheck/>pathcheck</a></li><li><a href=/docs/steps/py/>py</a></li><li><a href=/docs/steps/pyimport/>pyimport</a></li><li><a href=/docs/steps/pype/>pype</a></li><li><a href=/docs/steps/pypyrversion/>pypyrversion</a></li><li><a href=/docs/steps/python/>python</a></li><li><a href=/docs/steps/safeshell/>safeshell</a></li><li><a href=/docs/steps/set/>set</a></li><li><a href=/docs/steps/shell/>shell</a></li><li><a href=/docs/steps/stop/>stop</a></li><li><a href=/docs/steps/stoppipeline/>stoppipeline</a></li><li><a href=/docs/steps/stopstepgroup/>stopstepgroup</a></li><li><a href=/docs/steps/tar/>tar</a></li></ul></li><li><button class="nav-section-chevron-title neutral-button">
<span class=nav-section-pointer><svg class="nav-chevron"><title>open or close sub-menu</title><use href="https://pypyr.io/icons/chevron-right.e586e5df0f820697b2ce08d042d0110568a2faeb11c7f0bab5a33df79dd3d6db.svg#chevron-right"/></svg><span>substitutions</span></span></button><ul class=nested><li><a href=/docs/substitutions/>overview</a></li><li><a href=/docs/substitutions/format-string/>format string</a></li><li><a href=/docs/substitutions/jsonify/>jsonify</a></li><li><a href=/docs/substitutions/py-strings/>py string</a></li><li><a href=/docs/substitutions/sic-strings/>sic string</a></li></ul></li><li><button class="nav-section-chevron-title neutral-button">
<span class=nav-section-pointer><svg class="nav-chevron"><title>open or close sub-menu</title><use href="https://pypyr.io/icons/chevron-right.e586e5df0f820697b2ce08d042d0110568a2faeb11c7f0bab5a33df79dd3d6db.svg#chevron-right"/></svg><span>plugins</span></span></button><ul class=nested><li><a href=/docs/plugins/>overview</a></li><li><button class="nav-section-chevron-title neutral-button">
<span class=nav-section-pointer><svg class="nav-chevron"><title>open or close sub-menu</title><use href="https://pypyr.io/icons/chevron-right.e586e5df0f820697b2ce08d042d0110568a2faeb11c7f0bab5a33df79dd3d6db.svg#chevron-right"/></svg><span>aws</span></span></button><ul class=nested><li><a href=/docs/plugins/aws/>overview</a></li><li><a href=/docs/plugins/aws/authentication/>authentication</a></li><li><a href=/docs/plugins/aws/substitutions/>substitutions</a></li><li><button class="nav-section-chevron-title neutral-button">
<span class=nav-section-pointer><svg class="nav-chevron"><title>open or close sub-menu</title><use href="https://pypyr.io/icons/chevron-right.e586e5df0f820697b2ce08d042d0110568a2faeb11c7f0bab5a33df79dd3d6db.svg#chevron-right"/></svg><span>steps</span></span></button><ul class=nested><li><a href=/docs/plugins/aws/steps/>overview</a></li><li><a href=/docs/plugins/aws/steps/client/>client</a></li><li><a href=/docs/plugins/aws/steps/ecswaitprep/>ecswaitprep</a></li><li><a href=/docs/plugins/aws/steps/s3fetchjson/>s3fetchjson</a></li><li><a href=/docs/plugins/aws/steps/s3fetchyaml/>s3fetchyaml</a></li><li><a href=/docs/plugins/aws/steps/wait/>wait</a></li><li><a href=/docs/plugins/aws/steps/waitfor/>waitfor</a></li></ul></li></ul></li><li><button class="nav-section-chevron-title neutral-button">
<span class=nav-section-pointer><svg class="nav-chevron"><title>open or close sub-menu</title><use href="https://pypyr.io/icons/chevron-right.e586e5df0f820697b2ce08d042d0110568a2faeb11c7f0bab5a33df79dd3d6db.svg#chevron-right"/></svg><span>slack</span></span></button><ul class=nested><li><a href=/docs/plugins/slack/>overview</a></li><li><a href=/docs/plugins/slack/authentication/>authentication</a></li><li><button class="nav-section-chevron-title neutral-button">
<span class=nav-section-pointer><svg class="nav-chevron"><title>open or close sub-menu</title><use href="https://pypyr.io/icons/chevron-right.e586e5df0f820697b2ce08d042d0110568a2faeb11c7f0bab5a33df79dd3d6db.svg#chevron-right"/></svg><span>steps</span></span></button><ul class=nested><li><a href=/docs/plugins/slack/steps/>overview</a></li><li><a href=/docs/plugins/slack/steps/send/>send</a></li></ul></li></ul></li></ul></li><li><button class="nav-section-chevron-title neutral-button">
<span class=nav-section-pointer><svg class="nav-chevron nav-chevron-down"><title>open or close sub-menu</title><use href="https://pypyr.io/icons/chevron-right.e586e5df0f820697b2ce08d042d0110568a2faeb11c7f0bab5a33df79dd3d6db.svg#chevron-right"/></svg><span>api</span></span></button><ul class="nested expand"><li><a href=/docs/api/>overview</a></li><li><a href=/docs/api/custom-module-search-path/>custom module search path</a></li><li><a href=/docs/api/context-parser/>context parser</a></li><li><a href=/docs/api/pipeline-loader/>pipeline loader</a></li><li><a href=/docs/api/retry-backoff/>retry backoff</a></li><li class=currentpage><a href=/docs/api/run-pipeline/>run pipeline</a></li><li><a href=/docs/api/step/>step</a></li></ul></li><li><button class="nav-section-chevron-title neutral-button">
<span class=nav-section-pointer><svg class="nav-chevron"><title>open or close sub-menu</title><use href="https://pypyr.io/icons/chevron-right.e586e5df0f820697b2ce08d042d0110568a2faeb11c7f0bab5a33df79dd3d6db.svg#chevron-right"/></svg><span>contributing</span></span></button><ul class=nested><li><a href=/docs/contributing/>overview</a></li><li><a href=/docs/contributing/contribute-to-pypyr/>contribute to pypyr</a></li><li><a href=/docs/contributing/developers-guide/>developer's guide for pypyr</a></li></ul></li><li><button class="nav-section-chevron-title neutral-button">
<span class=nav-section-pointer><svg class="nav-chevron"><title>open or close sub-menu</title><use href="https://pypyr.io/icons/chevron-right.e586e5df0f820697b2ce08d042d0110568a2faeb11c7f0bab5a33df79dd3d6db.svg#chevron-right"/></svg><span>thank you</span></span></button><ul class=nested><li><a href=/docs/thank-you/>overview</a></li><li><a href=/docs/thank-you/built-with-hugo/>built with hugo</a></li><li><a href=/docs/thank-you/dependencies/>dependencies</a></li></ul></li></ul></nav><div class="docs-content content-grid"><ol class=breadcrumb vocab="http://schema.org/" typeof="BreadcrumbList"><li property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" href=https://pypyr.io/><span property="name">pypyr</span></a><meta property="position" content="1"></li><li property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" href=https://pypyr.io/docs/><span property="name">docs</span></a><meta property="position" content="2"></li><li property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" href=https://pypyr.io/docs/api/><span property="name">api</span></a><meta property="position" content="3"></li><li property="itemListElement" typeof="ListItem"><span property="name">run pipeline api</span><meta property="position" content="4"></li></ol><aside class="grid-toc elevation-02"><h6 id=table-of-contents>on this page</h6><nav id=TableOfContents><ol><li><a href=#run-entry-point>run() entry-point</a><ol><li><a href=#input-args>input args</a></li><li><a href=#returns>returns</a></li></ol></li><li><a href=#passing-values-to-the-pipeline>passing values to the pipeline</a><ol><li><a href=#args_in-vs-dict_in>args_in vs dict_in</a></li><li><a href=#args_in-list>args_in list</a></li><li><a href=#invoke-pipeline-from-api-with-no-input-context>invoke pipeline from api with no input context</a></li></ol></li><li><a href=#initialize-config>initialize config</a></li><li><a href=#shortcuts>shortcuts</a></li><li><a href=#logging>logging</a><ol><li><a href=#log-levels>log levels</a></li><li><a href=#set_root_logger-input-args>set_root_logger input args</a></li></ol></li></ol></nav></aside><main class=grid-main><article><h1 id=run-a-pipeline-from-the-api>run a pipeline from the api <a href=#run-a-pipeline-from-the-api class=headline-anchor aria-label=anchor><svg class="permalink"><title>permalink</title><use href="https://pypyr.io/icons/external-link.054f8ebb57944b2bc52ea4f0ecd16197.svg#external-link"/></svg></a></h1><p>You can run a pypyr automation pipeline programmatically from your own code
using the python api.</p><p>Here&rsquo;s a silly pipeline:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># ./pipeline-dir/my-pipe.yaml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>context_parser</span><span class=p>:</span><span class=w> </span><span class=l>pypyr.parser.keyvaluepairs</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>steps</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>pypyr.steps.echo</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>in</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>echoMe</span><span class=p>:</span><span class=w> </span><span class=l>piper {arbkey} that {anotherkey} again</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>pypyr.steps.set</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>in</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>set</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>myoutput</span><span class=p>:</span><span class=w> </span><span class=l>I was set in the pipeline!</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>input_values</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=s1>&#39;{arbkey}&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=s1>&#39;{anotherkey}&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>some_nesting</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>down_level</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>arb_number</span><span class=p>:</span><span class=w> </span><span class=m>123</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>arb_bool</span><span class=p>:</span><span class=w> </span><span class=kc>False</span><span class=w>
</span></span></span></code></pre></div><p>Run this pipeline from the cli like this:</p><div class=app-window><div class=app-window-top-bar><span class=app-window-buttons><span class="circle red"></span><span class="circle yellow"></span><span class="circle green"></span></span>
<span class=app-window-title>term</span></div><div class=app-window-content><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>$ pypyr pipeline-dir/my-pipe arbkey=pipe anotherkey=song
</span></span><span class=line><span class=cl>piper pipe that song again
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$</span></span></code></pre></div></div></div><p>You can run this same pipeline programmatically with the same inputs like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Optional. If you want to see pypyr stdout output, log level should be &lt;= 25</span>
</span></span><span class=line><span class=cl><span class=c1># import logging</span>
</span></span><span class=line><span class=cl><span class=c1># logging.basicConfig(level=25)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pypyr</span> <span class=kn>import</span> <span class=n>pipelinerunner</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># You can run a pipeline via the API like this:</span>
</span></span><span class=line><span class=cl><span class=n>context</span> <span class=o>=</span> <span class=n>pipelinerunner</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>pipeline_name</span><span class=o>=</span><span class=s1>&#39;pipeline-dir/my-pipe&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                             <span class=n>args_in</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;arbkey=pipe&#39;</span><span class=p>,</span> <span class=s1>&#39;anotherkey=song&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Or like this:</span>
</span></span><span class=line><span class=cl><span class=n>context</span> <span class=o>=</span> <span class=n>pipelinerunner</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>pipeline_name</span><span class=o>=</span><span class=s1>&#39;pipeline-dir/my-pipe&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                             <span class=n>dict_in</span><span class=o>=</span><span class=p>{</span><span class=s1>&#39;arbkey&#39;</span><span class=p>:</span> <span class=s1>&#39;pipe&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                      <span class=s1>&#39;anotherkey&#39;</span><span class=p>:</span> <span class=s1>&#39;song&#39;</span><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># context behaves like a dict</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>context</span><span class=p>[</span><span class=s1>&#39;myoutput&#39;</span><span class=p>])</span>  <span class=c1># I was set in the pipeline!</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>context</span><span class=p>[</span><span class=s1>&#39;input_values&#39;</span><span class=p>][</span><span class=mi>0</span><span class=p>])</span>  <span class=c1># pipe</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>context</span><span class=p>[</span><span class=s1>&#39;some_nesting&#39;</span><span class=p>][</span><span class=s1>&#39;down_level&#39;</span><span class=p>][</span><span class=s1>&#39;arb_number&#39;</span><span class=p>])</span>  <span class=c1># 123</span>
</span></span></code></pre></div><p>Use the <code>run()</code> function in the <code>pypyr.pipelinerunner</code> module to run a pipeline.
For the exact same behavior as the CLI, you also have to <a href=#initialize-config>initialize
config</a> and <a href=#logging>logging</a>.</p><p>This example shows two different ways of initializing the pipeline&rsquo;s context:
both are equivalent and results in the same values being passed to the pipeline -
the pipeline step sequences run identically. For this example pipeline, the
output <code>context</code> for both <code>run()</code> calls is identical. See <a href=#passing-values-to-the-pipeline>initialize
context</a> for details on <code>args_in</code> vs <code>dict_in</code>.</p><p><code>run()</code> returns the pypyr <code>Context</code> object to you as it is after the pipeline
completes, giving you access to any mutations the pipeline made to it.</p><h2 id=run-entry-point>run() entry-point <a href=#run-entry-point class=headline-anchor aria-label=anchor><svg class="permalink"><title>permalink</title><use href="https://pypyr.io/icons/external-link.054f8ebb57944b2bc52ea4f0ecd16197.svg#external-link"/></svg></a></h2><p>This is the full <code>pypyr.pipelinerunner.run()</code> function signature:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>run</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=n>pipeline_name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=n>args_in</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=n>parse_args</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=n>dict_in</span><span class=p>:</span> <span class=nb>dict</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=n>groups</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=n>success_group</span><span class=p>:</span> <span class=nb>str</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=n>failure_group</span><span class=p>:</span> <span class=nb>str</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=n>loader</span><span class=p>:</span> <span class=nb>str</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=n>py_dir</span><span class=p>:</span> <span class=nb>str</span> <span class=o>|</span> <span class=nb>bytes</span> <span class=o>|</span> <span class=n>PathLike</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pypyr</span><span class=o>.</span><span class=n>context</span><span class=o>.</span><span class=n>Context</span><span class=p>:</span>
</span></span></code></pre></div><h3 id=input-args>input args <a href=#input-args class=headline-anchor aria-label=anchor><svg class="permalink"><title>permalink</title><use href="https://pypyr.io/icons/external-link.054f8ebb57944b2bc52ea4f0ecd16197.svg#external-link"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pypyr.pipelinerunner</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>out</span> <span class=o>=</span> <span class=n>pypyr</span><span class=o>.</span><span class=n>pipelinerunner</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>pipeline_name</span><span class=o>=</span><span class=s1>&#39;arb-pipe&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                               <span class=n>args_in</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;arb&#39;</span><span class=p>,</span> <span class=s1>&#39;context input&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                               <span class=n>parse_args</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                               <span class=n>dict_in</span><span class=o>=</span><span class=p>{</span><span class=s1>&#39;key&#39;</span><span class=p>:</span> <span class=s1>&#39;value&#39;</span><span class=p>,</span> <span class=s1>&#39;arbkey&#39;</span><span class=p>:</span> <span class=s1>&#39;arb value&#39;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>                               <span class=n>groups</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;group1&#39;</span><span class=p>,</span> <span class=s1>&#39;group2&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                               <span class=n>success_group</span><span class=o>=</span><span class=s1>&#39;success_group&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                               <span class=n>failure_group</span><span class=o>=</span><span class=s1>&#39;failure_group&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                               <span class=n>loader</span><span class=o>=</span><span class=s1>&#39;mypackage.myloader&#39;</span>
</span></span><span class=line><span class=cl>                               <span class=n>py_dir</span><span class=o>=</span><span class=s1>&#39;arb/dir&#39;</span><span class=p>)</span>
</span></span></code></pre></div><ul><li><code>pipeline_name</code>: string. Required.<ul><li>Name of pipeline, sans .yaml at end.</li><li><code>{pipeline_name}.yaml</code> is relative to the current working directory.</li><li>You can also specify an absolute path here (again, just leave out the
.yaml at the end).</li></ul></li><li><code>args_in</code>: list of string. Optional.<ul><li>Initialize the pypyr context with this list of strings.</li><li>Use the python shlex split function on a string to get a parsed list.</li><li>If not specified pypyr will create an empty <code>Context</code> object for you,
depending on how the pipeline&rsquo;s <code>context_parser</code> handles <code>None</code> input.</li></ul></li><li><code>parse_args</code>: Boolean. Optional.<ul><li>Explicitly set whether to run the <code>context_parser</code> on the pipeline.</li><li>If you set <code>args_in</code>, <code>parse_args</code> defaults to <code>True</code>.</li><li>If you set <code>dict_in</code> and NOT <code>args_in</code>, pypyr assumes you don&rsquo;t want to run
the pipeline&rsquo;s context parser to initiate context and defaults <code>parse_args</code>
to <code>False</code>.</li></ul></li><li><code>dict_in</code>: dict. Optional.<ul><li>Initialize the pypyr <code>Context</code> object with this dict.</li><li>If not specified pypyr will create an empty <code>Context</code> for you.</li><li>If you set both <code>dict_in</code> AND <code>args_in</code>, pypyr will initialize Context with
<code>dict_in</code> and then merge the results of <code>args_in</code> processed by the
pipeline&rsquo;s <code>context_parser</code> into that before running the pipeline with the
resulting combined context. This is probably what you want by default, since
the point of using <code>dict_in</code> is to bypass the inefficient string parsing of
the context_parser.</li></ul></li><li><code>groups</code>: list of string. Optional.<ul><li>Step-group names to run in pipeline.</li><li>Defaults to <code>['steps']</code> if not specified.</li></ul></li><li><code>success_group</code>: string. Optional.<ul><li>Step-group name to run on success completion.</li><li>Defaults to <code>on_success</code> if not specified.</li></ul></li><li><code>failure_group</code>: string. Optional.<ul><li>Step-group name to run on pipeline failure.</li><li>Defaults to <code>on_failure</code> if not specified.</li></ul></li><li><code>loader</code>: string. Optional.<ul><li>Absolute name of pipeline loader module.</li><li>If not specified will use <code>pypyr.loaders.file</code> - the standard builtin pypyr
pipeline loader.</li></ul></li><li><code>py_dir</code>: Path-like. Optional.<ul><li>Look for custom modules in this directory.</li><li>Under the hood, pypyr adds this directory to <code>sys.path</code>.</li><li>This is useful if your pipeline uses <em>ad hoc</em> .py files that are NOT
installed in the current Python environment.</li><li>Be aware that if you use the standard default file loader, pypyr will add
the pipeline&rsquo;s parent directory automatically for you after it finds the
pipeline. You therefore do NOT need to set <code>py_dir</code> to the pipeline
directory when using the default loader.</li><li>If you are using a custom loader that is not installed in the current Python
environment, you have to set <code>py_dir</code> to allow pypyr to find it.</li><li>If you have installed (typically with <code>$ pip install</code>) all the custom
modules your pipeline uses into the current Python environment you do NOT
need to set <code>py_dir</code>.</li><li>If your <code>sys.path</code> already contains the necessary paths to discover the
custom modules that your pipeline uses, you do NOT need to set this.</li><li>If your pipeline does NOT use any custom Python modules, you do NOT need to
set <code>py_dir</code>.</li></ul></li></ul><h3 id=returns>returns <a href=#returns class=headline-anchor aria-label=anchor><svg class="permalink"><title>permalink</title><use href="https://pypyr.io/icons/external-link.054f8ebb57944b2bc52ea4f0ecd16197.svg#external-link"/></svg></a></h3><p>The pypyr context as it is after the pipeline completes. This is of type
<code>pypyr.context.Context()</code>. Each pipeline invocation uses its own fresh context -
a context is unique to a single root pipeline run.</p><p>The <code>Context</code> object behaves pretty much like a standard <code>dict</code>.</p><h2 id=passing-values-to-the-pipeline>passing values to the pipeline <a href=#passing-values-to-the-pipeline class=headline-anchor aria-label=anchor><svg class="permalink"><title>permalink</title><use href="https://pypyr.io/icons/external-link.054f8ebb57944b2bc52ea4f0ecd16197.svg#external-link"/></svg></a></h2><p>If you want to inject values into the pipeline you are running, you do so by
initializing the context for the pipeline run with the data you need.</p><h3 id=args_in-vs-dict_in>args_in vs dict_in <a href=#args_in-vs-dict_in class=headline-anchor aria-label=anchor><svg class="permalink"><title>permalink</title><use href="https://pypyr.io/icons/external-link.054f8ebb57944b2bc52ea4f0ecd16197.svg#external-link"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Initialize context with args_in:</span>
</span></span><span class=line><span class=cl><span class=n>context_out_1</span> <span class=o>=</span> <span class=n>pipelinerunner</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>pipeline_name</span><span class=o>=</span><span class=s1>&#39;pipeline-dir/my-pipe&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                   <span class=n>args_in</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;arbkey=pipe&#39;</span><span class=p>,</span> <span class=s1>&#39;anotherkey=song&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Or with dict_in:</span>
</span></span><span class=line><span class=cl><span class=n>context_out_2</span> <span class=o>=</span> <span class=n>pipelinerunner</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>pipeline_name</span><span class=o>=</span><span class=s1>&#39;pipeline-dir/my-pipe&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                   <span class=n>dict_in</span><span class=o>=</span><span class=p>{</span><span class=s1>&#39;arbkey&#39;</span><span class=p>:</span> <span class=s1>&#39;pipe&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                            <span class=s1>&#39;anotherkey&#39;</span><span class=p>:</span> <span class=s1>&#39;song&#39;</span><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Both results in the pipeline running the same, with the same output</span>
</span></span><span class=line><span class=cl><span class=k>assert</span> <span class=n>context_out_1</span> <span class=o>==</span> <span class=n>context_out_2</span>
</span></span></code></pre></div><p>You can initialize context in 2 different ways:</p><ul><li><code>args_in</code><ul><li>Use this if you want to pass context arguments to the pipeline&rsquo;s
<code>context_parser</code> in exactly the same way as the cli does - as a list of
strings.</li><li>This makes it the pipeline&rsquo;s <code>context_parser</code>&rsquo;s responsibility to
interpret & parse those strings.</li></ul></li><li><code>dict_in</code><ul><li>Use this if you have your own dict-like structure you want to pass to
your pipeline.</li><li>This will bypass the pipeline&rsquo;s <code>context_parser</code> and use
your input dict directly to initialize the pypyr Context.</li><li>This way you can directly control the context structure and the types of
the values you put in it.</li></ul></li></ul><p>You can also set both <code>dict_in</code> and <code>args_in</code> - in which case pypyr will
initialize context with <code>dict_in</code>, run the <code>context_parser</code> with <code>args_in</code> and
then merge the results of both into a single context before running the
pipeline with the combined context.</p><p>You can use whichever you prefer when you invoke your pipelines
programmatically. Either way is identical for actual pipeline control-of-flow
execution - the only difference is how you initialize the context that the
pipeline will use.</p><div class="admonition tip" role=figure><div class=admonition-tip-icon></div><div class=admonition-content><p>Now, having said that, parsing input strings and inferring types with the
<code>context_parser</code> (like you have to when the cli is passing the values) is
inherently inefficient. Since you are in structured Python code already when
using the API, you might as well prefer <code>dict_in</code> to <code>args_in</code>.</p><p>What works well is to set a <code>context_parser</code> in your pipeline yaml, which allows
you to use it from the cli with custom arguments, and then you can just bypass
the <code>context_parser</code> when you use the API by using <code>dict_in</code> explicitly to
initialize the Context exactly how you want it. This allows you to call the same
pipeline from both the cli and the api - and if you only pass <code>dict_in</code> to the
api rather than <code>args_in</code>, pypyr will automatically bypass the <code>context_parser</code>
for you unless you explicitly set <code>parse_args</code> to <code>True</code>.</p></div></div><h3 id=args_in-list>args_in list <a href=#args_in-list class=headline-anchor aria-label=anchor><svg class="permalink"><title>permalink</title><use href="https://pypyr.io/icons/external-link.054f8ebb57944b2bc52ea4f0ecd16197.svg#external-link"/></svg></a></h3><p><code>args_in</code> takes a list of strings. This is a POSIX style argument split on the
input arguments following the pipeline name as passed from the cli.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>$ pypyr mypipeline arg1 &#34;arg 2&#34; arg3=4
</span></span></code></pre></div><p>Equates to <code>args_in</code> of:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=p>[</span><span class=s1>&#39;arg1&#39;</span><span class=p>,</span> <span class=s1>&#39;arg 2&#39;</span><span class=p>,</span> <span class=s1>&#39;arg3=4&#39;</span><span class=p>]</span>
</span></span></code></pre></div><p>If you have a single string representing all the input arguments, a convenient
way to split it into a list while honoring escape sequences & quotes is to use
the built-in python <a href=https://docs.python.org/3/library/shlex.html#shlex.split>shlex
split</a> function.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>shlex</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pypyr</span> <span class=kn>import</span> <span class=n>pipelinerunner</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># For a pipeline that you&#39;d run from the cli like this:</span>
</span></span><span class=line><span class=cl><span class=c1># $ pypyr pipeline-dir/my-pipe arbkey=pipe anotherkey=&#34;song with a space&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>in_args</span> <span class=o>=</span> <span class=n>shlex</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;arbkey=pipe anotherkey=&#34;song with a space &#34;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># shlex result: [&#39;arbkey=pipe&#39;, &#39;anotherkey=song with a space &#39;]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pipelinerunner</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>pipeline_name</span><span class=o>=</span><span class=s1>&#39;pipeline-dir/my-pipe&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                   <span class=n>args_in</span><span class=o>=</span><span class=n>in_args</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=invoke-pipeline-from-api-with-no-input-context>invoke pipeline from api with no input context <a href=#invoke-pipeline-from-api-with-no-input-context class=headline-anchor aria-label=anchor><svg class="permalink"><title>permalink</title><use href="https://pypyr.io/icons/external-link.054f8ebb57944b2bc52ea4f0ecd16197.svg#external-link"/></svg></a></h3><p>Setting an input context is optional. It&rsquo;s only relevant when you have to pass
values into your pipeline.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># ./no-input-context.yaml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>steps</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>pypyr.steps.py</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>in</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>py</span><span class=p>:</span><span class=w> </span><span class=l>print(&#39;hello hello!&#39;)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>pypyr.steps.set</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>in</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>set</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>arbkey</span><span class=p>:</span><span class=w> </span><span class=l>I was set in the pipeline!</span><span class=w>
</span></span></span></code></pre></div><p>You can run this pipeline like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># For a pipeline ./no-input-context.yaml</span>
</span></span><span class=line><span class=cl><span class=c1># that you&#39;d run from the cli like this:</span>
</span></span><span class=line><span class=cl><span class=c1># $ pypyr no-input-context</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pypyr</span> <span class=kn>import</span> <span class=n>pipelinerunner</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>out</span> <span class=o>=</span> <span class=n>pipelinerunner</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=s1>&#39;no-input-context&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>out</span><span class=p>[</span><span class=s1>&#39;arbkey&#39;</span><span class=p>])</span> <span class=c1># I was set in the pipeline!</span>
</span></span></code></pre></div><h2 id=initialize-config>initialize config <a href=#initialize-config class=headline-anchor aria-label=anchor><svg class="permalink"><title>permalink</title><use href="https://pypyr.io/icons/external-link.054f8ebb57944b2bc52ea4f0ecd16197.svg#external-link"/></svg></a></h2><p>By default, when you call <code>run()</code> pypyr will use default configuration values
and &ldquo;just work&rdquo; without you having to do anything special.</p><p>If you want to follow the <a href=https://pypyr.io/docs/getting-started/config/>configuration look-up sequences</a> where pypyr looks for yaml/toml config
sources on disk, you explicitly need to tell pypyr to do so using
<code>config.init()</code>.</p><p>Because this is a relatively expensive operation you probably only want to run
this once per Python session, regardless of how many pipelines you execute with
<code>pipelinerunner.run()</code>. That said, if you really wanted to you could run it
multiple times to reconfigure pypyr on the fly.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pypyr</span> <span class=kn>import</span> <span class=n>pipelinerunner</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pypyr.config</span> <span class=kn>import</span> <span class=n>config</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># initialize config once</span>
</span></span><span class=line><span class=cl><span class=n>config</span><span class=o>.</span><span class=n>init</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># run multiple pipelines</span>
</span></span><span class=line><span class=cl><span class=n>out1</span> <span class=o>=</span> <span class=n>pipelinerunner</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=s1>&#39;my-pipeline-1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>out2</span> <span class=o>=</span> <span class=n>pipelinerunner</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=s1>&#39;my-pipeline-2&#39;</span><span class=p>)</span>
</span></span></code></pre></div><p>If your code invokes <code>config.init()</code>, you can still bypass the heavy
initialization sequence on-the-fly by using the <a href=https://pypyr.io/docs/getting-started/config/#pypyr_skip_init>PYPYR_SKIP_INIT</a> environment variable.</p><h2 id=shortcuts>shortcuts <a href=#shortcuts class=headline-anchor aria-label=anchor><svg class="permalink"><title>permalink</title><use href="https://pypyr.io/icons/external-link.054f8ebb57944b2bc52ea4f0ecd16197.svg#external-link"/></svg></a></h2><p>If you <a href=#initialize-config>initialize config</a>, pypyr will automatically check
if the <code>pipeline_name</code> you pass to <code>run()</code> is a recognized <a href=https://pypyr.io/docs/pipelines/shortcuts/#shortcut-name>shortcut name</a>.</p><p>If it is a shortcut, pypyr will run the pipeline using the inputs configured by
the shortcut rather than the arguments you pass to <code>run()</code> function. If
<code>pipeline_name</code> does not match a shortcut, pypyr will continue on to the default
pipeline discovery process.</p><p>So given shortcut configuration like this:<div class=tabs><input type=radio id=shortcuts-radio-config.yaml name=shortcuts-selector class=tab-radio tabindex=0 checked>
<label for=shortcuts-radio-config.yaml class=tab-label>config.yaml</label><div class=tab><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>shortcuts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>my-shortcut</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>pipeline_name</span><span class=p>:</span><span class=w> </span><span class=l>/mydir/my-pipeline</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>args</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>akey</span><span class=p>:</span><span class=w> </span><span class=l>a value</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>anotherkey</span><span class=p>:</span><span class=w> </span><span class=m>123</span><span class=w>
</span></span></span></code></pre></div></div><input type=radio id=shortcuts-radio-pyproject.toml name=shortcuts-selector class=tab-radio tabindex=0>
<label for=shortcuts-radio-pyproject.toml class=tab-label>pyproject.toml</label><div class=tab><div class=highlight><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>[</span><span class=nx>tool</span><span class=p>.</span><span class=nx>pypyr</span><span class=p>.</span><span class=nx>shortcuts</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>tool</span><span class=p>.</span><span class=nx>pypyr</span><span class=p>.</span><span class=nx>shortcuts</span><span class=p>.</span><span class=nx>my-shortcut</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=nx>pipeline_name</span> <span class=p>=</span> <span class=s2>&#34;/mydir/my-pipeline&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nx>args</span> <span class=p>=</span> <span class=p>{</span><span class=nx>akey</span> <span class=p>=</span> <span class=s2>&#34;a value&#34;</span><span class=p>,</span> <span class=nx>anotherkey</span> <span class=p>=</span> <span class=mi>123</span> <span class=p>}</span>
</span></span></code></pre></div></div></div></p><p>You can run like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pypyr</span> <span class=kn>import</span> <span class=n>pipelinerunner</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pypyr.config</span> <span class=kn>import</span> <span class=n>config</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># initialize config once</span>
</span></span><span class=line><span class=cl><span class=n>config</span><span class=o>.</span><span class=n>init</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># since config is initialized, pypyr can check for shortcuts too</span>
</span></span><span class=line><span class=cl><span class=n>out</span> <span class=o>=</span> <span class=n>pipelinerunner</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=s1>&#39;my-shortcut&#39;</span><span class=p>)</span>
</span></span></code></pre></div><p>If pypyr finds a matching shortcut:</p><ul><li><code>args_in</code>, if any, appends to the end of the shortcut&rsquo;s <code>parser_args</code></li><li><code>dict_in</code>, if any, merges into the shortcut&rsquo;s <code>args</code></li><li><code>parse_args</code> is ignored entirely. The value is calculated only from shortcut
configuration.<ul><li>The calculation is: <code>parse_args</code> will be <code>False</code> if (<code>shortcut.args</code> +
<code>dict_in</code>) exists and (<code>args_in</code> + <code>shortcut.parser_args</code>) does NOT exist.</li><li>In all other cases, <code>parse_args</code> will be <code>True</code>.</li></ul></li><li>For any of the other arguments, pypyr will fall back to the values you
provide to the <code>run()</code> function if the shortcut does not specify any.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pypyr</span> <span class=kn>import</span> <span class=n>pipelinerunner</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pypyr.config</span> <span class=kn>import</span> <span class=n>config</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>config</span><span class=o>.</span><span class=n>init</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># inputs to run() treated as fallback defaults</span>
</span></span><span class=line><span class=cl><span class=n>out</span> <span class=o>=</span> <span class=n>pipelinerunner</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=s1>&#39;my-shortcut&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                         <span class=n>args_in</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;one&#39;</span><span class=p>,</span> <span class=s1>&#39;two&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                         <span class=n>dict_in</span><span class=o>=</span><span class=p>{</span><span class=s1>&#39;a&#39;</span><span class=p>:</span> <span class=s1>&#39;b&#39;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>                         <span class=n>loader</span><span class=o>=</span><span class=s1>&#39;myloader&#39;</span><span class=p>)</span>
</span></span></code></pre></div><p>In this example,</p><ul><li><code>args_in</code> will append to the end of the shortcut <code>parser_args</code>.<ul><li>uses <code>args_in</code> if no shortcut <code>parser_args</code> exist.</li></ul></li><li><code>dict_in</code> will merge into the shortcut&rsquo;s <code>args</code>.<ul><li>uses <code>dict_in</code> if no shortcut <code>args</code> exist.</li></ul></li><li>if the shortcut does not specify a value for <code>loader</code>, pypyr will fallback
to use <code>myloader</code>.</li></ul><h2 id=logging>logging <a href=#logging class=headline-anchor aria-label=anchor><svg class="permalink"><title>permalink</title><use href="https://pypyr.io/icons/external-link.054f8ebb57944b2bc52ea4f0ecd16197.svg#external-link"/></svg></a></h2><p>By default python runs with a log level of 30 (WARNING). This means you won&rsquo;t
see pypyr NOTIFY output like <a href=https://pypyr.io/docs/steps/echo/>pypyr.steps.echo</a>
or <a href=https://pypyr.io/docs/decorators/description/>description output</a> when you
invoke the pypyr api from your own code without setting the log-level. This is
because, as an API, pypyr shouldn&rsquo;t clutter your stdout unless you explicitly
tell it to do so.</p><p>If you&rsquo;re invoking pypyr via the API from your own application, it&rsquo;s your
responsibility to set up and configure logging. If you just want the same log
handlers & formatters that the pypyr cli uses, you can call
<a href=#set_root_logger-input-args>pypyr.log.logger.set_root_logger()</a> before
invoking <code>pipelinerunner.run()</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pypyr</span> <span class=kn>import</span> <span class=n>pipelinerunner</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pypyr.config</span> <span class=kn>import</span> <span class=n>config</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pypyr.log.logger</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># optional - one-time loading of config from files</span>
</span></span><span class=line><span class=cl><span class=n>config</span><span class=o>.</span><span class=n>init</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># initialize logging once</span>
</span></span><span class=line><span class=cl><span class=c1># use the same log format &amp; level defaults as the cli</span>
</span></span><span class=line><span class=cl><span class=n>pypyr</span><span class=o>.</span><span class=n>log</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>set_root_logger</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># For a pipeline that you&#39;d run from the cli like this:</span>
</span></span><span class=line><span class=cl><span class=c1># $ pypyr pipeline-dir/my-pipe arbkey=pipe anotherkey=song</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>context_out</span> <span class=o>=</span> <span class=n>pipelinerunner</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=s1>&#39;pipeline-dir/my-pipe&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                 <span class=n>dict_in</span><span class=o>=</span><span class=p>{</span><span class=s1>&#39;arbkey&#39;</span><span class=p>:</span> <span class=s1>&#39;pipe&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                          <span class=s1>&#39;anotherkey&#39;</span><span class=p>:</span> <span class=s1>&#39;song&#39;</span><span class=p>})</span>
</span></span></code></pre></div><p>If you are calling both <code>config.init()</code> and <code>set_root_logger()</code>, be sure to call
<code>config.init()</code> FIRST, because this will allow the logger to get its
configuration from <a href=https://pypyr.io/docs/getting-started/config/>config</a>. You can
customize the logging output format with the config properties prefixed with
<code>log_</code>.</p><p>Be aware that pypyr adds a <code>NOTIFY</code> - <code>25</code> custom log-level and a <code>notify()</code>
function to <code>logging</code> in all cases, even when you don&rsquo;t call
<code>set_root_logger()</code>.</p><h3 id=log-levels>log levels <a href=#log-levels class=headline-anchor aria-label=anchor><svg class="permalink"><title>permalink</title><use href="https://pypyr.io/icons/external-link.054f8ebb57944b2bc52ea4f0ecd16197.svg#external-link"/></svg></a></h3><p>Log level enumeration:</p><ul><li>&lt; 10 gives full traceback on errors.</li><li>10=DEBUG</li><li>20=INFO</li><li>25=NOTIFY (default)</li><li>30=WARNING</li><li>40=ERROR</li><li>50=CRITICAL</li></ul><h3 id=set_root_logger-input-args>set_root_logger input args <a href=#set_root_logger-input-args class=headline-anchor aria-label=anchor><svg class="permalink"><title>permalink</title><use href="https://pypyr.io/icons/external-link.054f8ebb57944b2bc52ea4f0ecd16197.svg#external-link"/></svg></a></h3><p>Use <code>set_root_logger</code> when you want to use the same logging format as the cli.</p><p>This is optional. Your application is free to define its own log level and
handlers - in which case, don&rsquo;t bother with <code>set_root_logger()</code>.</p><p>If you do call <code>set_root_logger</code> do so once and only once at program
initialization.</p><p>Call <code>set_root_logger</code> only <em>after</em> <code>config.init()</code> if you want to override
logging defaults from yaml/toml configuration files. This is optional though,
since if you do not call <code>config.init()</code> at all <code>set_root_logger</code> will just use
the standard out-of-box defaults.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pypyr.log.logger</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pypyr</span><span class=o>.</span><span class=n>log</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>set_root_logger</span><span class=p>(</span><span class=n>log_level</span><span class=o>=</span><span class=mi>25</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                 <span class=n>log_path</span><span class=o>=</span><span class=s1>&#39;./dir/my-file.log&#39;</span><span class=p>)</span>
</span></span></code></pre></div><ul><li><code>log_level</code>: int. Optional.<ul><li>Defaults to <code>25</code> if not specified.</li></ul></li><li><code>log_path</code>: Path-like. Optional.<ul><li>If specified, append pypyr output to this file.</li><li>Defaults to <code>None</code> if not specified - which means output only goes to the
console.</li></ul></li></ul></article><section class="see-also elevation-02"><h2>see also</h2><ul><li><a href=/docs/api/custom-module-search-path/>custom module name resolution</a></li><li><a href=/docs/api/retry-backoff/>custom retry backoff</a></li><li><a href=/docs/api/>api</a></li><li><a href=/docs/api/context-parser/>custom context parser</a></li><li><a href=/docs/api/pipeline-loader/>custom pype loader</a></li></ul></section></main><aside class="grid-taxonomy elevation-02"><section class=page-taxonomy aria-label="related topics"><h6>topics</h6><ul id=topics class=small-list><li><a href=https://pypyr.io/topics/custom-code/ class=muted-with-hover>custom code</a></li></ul></section></aside><aside class="grid-improve elevation-02" aria-labelledby=feedback><h6 id=feedback>feedback</h6><ul class=small-list><li><a href=https://github.com/pypyr/docs/edit/main/content/docs/api/run-pipeline.md class=muted-with-hover>edit me</a></li><li><a href="https://github.com/pypyr/docs/issues/new?title=docs%20issue:run%20pipeline%20api&body=File:%20[run%20pipeline%20api]%28https://pypyr.io/docs/api/run-pipeline/%29" class=muted-with-hover>report typo</a></li><li><a href="https://github.com/pypyr/pypyr/issues/new?title=Re:%20run%20pipeline%20api&labels=bug" class=muted-with-hover>report bug!</a></li></ul></aside><div class="page-git-info elevation-02"><small class=small-block>last updated on <time datetime=2022-03-09T12:15:05Z>2022-03-09 12:15</time>.</small></div></div><footer class="footer elevation-01"><a href=/ class=top-nav-logo aria-label=home><img class=top-nav-logo-img src=https://pypyr.io/images/pypyr-logotype.2c9aa98c472f0ea8d436597c26ef1b0f042624ee19cdf69bcb89ac0025d146c4.svg alt="pypyr logo"></a><div class=col-1fr-centered><ul class=footer-social-links aria-label="social media links"><li><a href=https://twitter.com/pypyrpipes/ class=footer-social-link><div class=footer-social-links-pre><svg viewBox="0 0 400 400"><title>twitter link</title><use xlink:href="https://pypyr.io/icons/twitter-social-icon-circle-white.d715a98bf8d7170b3d2603d836ca675616731d85583c13d23ec468905e77c59a.svg#twitter-icon"/></svg></div><small>twitter</small></a></li><li><a href=https://github.com/pypyr/pypyr/ class=footer-social-link><div class=footer-social-links-pre><svg viewBox="0 0 32.58 31.77"><title>github link</title><use xlink:href="https://pypyr.io/icons/github-icon.778bc8065fb7e8d1e7109b270cfbd86e15e05bb16ebff30d261935e4bc1560bd.svg#github-icon"/></svg></div><small>github</small></a></li><li><a href=https://github.com/pypyr/pypyr/discussions class=footer-social-link><div class=footer-social-links-pre><svg viewBox="0 0 16 16"><title>discussion forum link</title><use xlink:href="https://pypyr.io/icons/discussions.a9f14951d81276183aaea73b6d616db95326f8f16350b221d9d6d48ee5a0b16e.svg#discussions-icon"/></svg></div><small>forum</small></a></li></ul><ul class=footer-notices-links aria-label="legal notices"><li><a href=/legal/privacy-notice class=muted-with-hover><small>privacy</small></a></li><li><a href=/legal/licensing class=muted-with-hover><small>licensing</small></a></li><li><a href=/press-kit class=muted-with-hover><small>press</small></a></li></ul></div></footer><div class=bottom-spacer aria-hidden=true></div><div id=disabled-state-overlay aria-hidden=true class="disabled-state-overlay hide-overlay"></div></body></html>